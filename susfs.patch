--- a/50_add_susfs_in_gki-android14-6.1.patch	2025-11-24 22:02:49.841879871 +0100
+++ b/50_add_susfs_in_gki-android14-6.1.patch	2025-11-24 22:12:47.000257000 +0100
@@ -28,7 +28,6 @@
  		if (type != EV_SYN)
  			add_input_randomness(type, code, value);
 diff --git a/fs/Makefile b/fs/Makefile
-index 102e4cd2bf69..a1929dbc8b8c 100644
 --- a/fs/Makefile
 +++ b/fs/Makefile
 @@ -17,6 +17,8 @@ obj-y :=	open.o read_write.o file_table.o super.o \
@@ -41,7 +40,6 @@
  obj-y +=	buffer.o direct-io.o mpage.o
  else
 diff --git a/fs/devpts/inode.c b/fs/devpts/inode.c
-index 4f25015aa534..17e9e15af730 100644
 --- a/fs/devpts/inode.c
 +++ b/fs/devpts/inode.c
 @@ -24,6 +24,9 @@
@@ -81,7 +79,6 @@
  		return NULL;
  	return dentry->d_fsdata;
 diff --git a/fs/exec.c b/fs/exec.c
-index 05ec9e6966cf..119874b8dc72 100644
 --- a/fs/exec.c
 +++ b/fs/exec.c
 @@ -64,6 +64,9 @@
@@ -132,7 +129,6 @@
  	 * We move the actual failure in case of RLIMIT_NPROC excess from
  	 * set*uid() to execve() because too many poorly written programs
 diff --git a/fs/namei.c b/fs/namei.c
-index 1fa36df7b667..e997ba39c615 100644
 --- a/fs/namei.c
 +++ b/fs/namei.c
 @@ -40,10 +40,23 @@
@@ -544,13 +540,14 @@
  	return filp;
  }
 diff --git a/fs/namespace.c b/fs/namespace.c
-index 67d89ebb5044..048bb3062669 100644
 --- a/fs/namespace.c
 +++ b/fs/namespace.c
-@@ -32,10 +32,23 @@
+@@ -32,12 +32,25 @@
  #include <linux/fs_context.h>
  #include <linux/shmem_fs.h>
  #include <linux/mnt_idmapping.h>
+ #include <linux/delay.h>
+ #include <linux/fslog.h>
 +#ifdef CONFIG_KSU_SUSFS_SUS_MOUNT
 +#include <linux/susfs_def.h>
 +#endif // #ifdef CONFIG_KSU_SUSFS_SUS_MOUNT
@@ -869,7 +866,6 @@
 +#endif
 +
 diff --git a/fs/notify/fdinfo.c b/fs/notify/fdinfo.c
-index 55081ae3a6ec..9757e54b3e33 100644
 --- a/fs/notify/fdinfo.c
 +++ b/fs/notify/fdinfo.c
 @@ -12,6 +12,9 @@
@@ -968,7 +964,6 @@
  			   inode_mark->wd, inode->i_ino, inode->i_sb->s_dev,
  			   inotify_mark_user_mask(mark));
 diff --git a/fs/open.c b/fs/open.c
-index 026a4047cb5d..df3e87ec40af 100644
 --- a/fs/open.c
 +++ b/fs/open.c
 @@ -33,6 +33,9 @@
@@ -1014,13 +1009,14 @@
  		return -EINVAL;
  
 diff --git a/fs/proc/base.c b/fs/proc/base.c
-index bf14f94df793..0ad67e7d7879 100644
 --- a/fs/proc/base.c
 +++ b/fs/proc/base.c
-@@ -99,6 +99,9 @@
+@@ -99,8 +99,11 @@
  #include <linux/resctrl.h>
  #include <linux/cn_proc.h>
  #include <linux/cpufreq_times.h>
+ #include <linux/task_integrity.h>
+ #include <linux/proca.h>
 +#ifdef CONFIG_KSU_SUSFS_SUS_MAP
 +#include <linux/susfs_def.h>
 +#endif
@@ -1075,7 +1071,6 @@
  			continue;
  
 diff --git a/fs/proc/bootconfig.c b/fs/proc/bootconfig.c
-index 2e244ada1f97..792e1cb04b11 100644
 --- a/fs/proc/bootconfig.c
 +++ b/fs/proc/bootconfig.c
 @@ -12,8 +12,19 @@
@@ -1099,7 +1094,6 @@
  		seq_puts(m, saved_boot_config);
  	return 0;
 diff --git a/fs/proc/fd.c b/fs/proc/fd.c
-index 913bef0d2a36..df3e37c93459 100644
 --- a/fs/proc/fd.c
 +++ b/fs/proc/fd.c
 @@ -13,6 +13,9 @@
@@ -1174,7 +1168,6 @@
  	show_fd_locks(m, file, files);
  	if (seq_has_overflowed(m))
 diff --git a/fs/proc/task_mmu.c b/fs/proc/task_mmu.c
-index d6f37ed840e5..8524560bb000 100644
 --- a/fs/proc/task_mmu.c
 +++ b/fs/proc/task_mmu.c
 @@ -21,6 +21,9 @@
@@ -1309,7 +1302,6 @@
  
  		len = min(count, PM_ENTRY_BYTES * pm.pos);
 diff --git a/fs/proc_namespace.c b/fs/proc_namespace.c
-index 846f9455ae22..1f6c127ba127 100644
 --- a/fs/proc_namespace.c
 +++ b/fs/proc_namespace.c
 @@ -12,12 +12,19 @@
@@ -1371,7 +1363,6 @@
  	if (sb->s_op->show_devname) {
  		seq_puts(m, "device ");
 diff --git a/fs/read_write.c b/fs/read_write.c
-index 7a2ff6157eda..684dd3e85e11 100644
 --- a/fs/read_write.c
 +++ b/fs/read_write.c
 @@ -618,8 +618,19 @@ ssize_t ksys_read(unsigned int fd, char __user *buf, size_t count)
@@ -1395,7 +1386,6 @@
  }
  
 diff --git a/fs/readdir.c b/fs/readdir.c
-index 9c53edb60c03..219685cc3c19 100644
 --- a/fs/readdir.c
 +++ b/fs/readdir.c
 @@ -24,6 +24,14 @@
@@ -1849,7 +1839,6 @@
  	if (error >= 0)
  		error = buf.error;
 diff --git a/fs/stat.c b/fs/stat.c
-index ef50573c72a2..4f0b22dc8b8d 100644
 --- a/fs/stat.c
 +++ b/fs/stat.c
 @@ -19,12 +19,20 @@
@@ -1927,7 +1916,6 @@
  		      AT_STATX_SYNC_TYPE))
  		return -EINVAL;
 diff --git a/fs/statfs.c b/fs/statfs.c
-index 96d1c3edf289..f8d47f5e7ea6 100644
 --- a/fs/statfs.c
 +++ b/fs/statfs.c
 @@ -9,6 +9,10 @@
@@ -1966,7 +1954,6 @@
  EXPORT_SYMBOL(vfs_statfs);
  
 diff --git a/include/linux/mount.h b/include/linux/mount.h
-index 23baecab7cae..3207b6107474 100644
 --- a/include/linux/mount.h
 +++ b/include/linux/mount.h
 @@ -76,7 +76,11 @@ struct vfsmount {
@@ -1982,7 +1969,6 @@
  
  static inline struct user_namespace *mnt_user_ns(const struct vfsmount *mnt)
 diff --git a/kernel/kallsyms.c b/kernel/kallsyms.c
-index 824bcc7b5dbc..1087f73ddca0 100644
 --- a/kernel/kallsyms.c
 +++ b/kernel/kallsyms.c
 @@ -833,6 +833,10 @@ static void s_stop(struct seq_file *m, void *p)
@@ -2034,7 +2020,6 @@
  }
  
 diff --git a/kernel/reboot.c b/kernel/reboot.c
-index 344ceaf5ed13..c2d1a782d5a5 100644
 --- a/kernel/reboot.c
 +++ b/kernel/reboot.c
 @@ -693,6 +693,9 @@ EXPORT_SYMBOL_GPL(kernel_power_off);
@@ -2064,7 +2049,6 @@
  	if (!ns_capable(pid_ns->user_ns, CAP_SYS_BOOT))
  		return -EPERM;
 diff --git a/kernel/sys.c b/kernel/sys.c
-index 9f8f4c1ccc65..7f2e512f99d9 100644
 --- a/kernel/sys.c
 +++ b/kernel/sys.c
 @@ -734,8 +734,17 @@ long __sys_setresuid(uid_t ruid, uid_t euid, uid_t suid)
@@ -2105,7 +2089,6 @@
  	if (copy_to_user(name, &tmp, sizeof(tmp)))
  		return -EFAULT;
 diff --git a/security/selinux/avc.c b/security/selinux/avc.c
-index d93af92498f5..15e526609b62 100644
 --- a/security/selinux/avc.c
 +++ b/security/selinux/avc.c
 @@ -47,6 +47,12 @@
